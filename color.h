//Ian Harvey
//Color header file

#ifndef COLOR_H
#define COLOR_H

#include <unordered_map>
using namespace std;

struct color {
  uint r, g, b;
  
  string hexString() {
    char rChars[3];
    sprintf(&(rChars[0]), "%x", r >> 4);
    sprintf(&(rChars[1]), "%x", r & 0xF);
    char gChars[3];
    sprintf(&(gChars[0]), "%x", g >> 4);
    sprintf(&(gChars[1]), "%x", g & 0xF);
    string rStr = (string) rChars;
    char bChars[3];
    sprintf(&(bChars[0]), "%x", b >> 4);
    sprintf(&(bChars[1]), "%x", b & 0xF);
    
    
    return (string) rChars + (string) gChars + (string) bChars;
  }

  color operator-(color other) {
    uint rMin = (r > other.r) ? (r - other.r) : (other.r - r);
    uint gMin = (g > other.g) ? (g - other.g) : (other.g - g);
    uint bMin = (b > other.b) ? (b - other.b) : (other.b - b);
    
    return { rMin, gMin, bMin };
  }
  
};


// I cannot believe that I manually set this
// There was definitely a better way to do this too but this code isn't that serious
unordered_map<string, tuple<string, color>> xtermANSI =
  {
    { "000000SYS", {"\033[38;5;0m█", { 0, 0, 0}} },
    { "800000SYS", {"\033[38;5;1m█", { 128, 0, 0}} },
    { "008000SYS", {"\033[38;5;2m█", { 0, 128, 0}} },
    { "808000SYS", {"\033[38;5;3m█", { 128, 128, 0}} },
    { "000080SYS", {"\033[38;5;4m█", { 0, 0, 128}} },
    { "800080SYS", {"\033[38;5;5m█", { 128, 0, 128}} },
    { "008080SYS", {"\033[38;5;6m█", { 0, 128, 128}} },
    { "c0c0c0SYS", {"\033[38;5;7m█", { 192, 192, 192}} },
    { "808080SYS", {"\033[38;5;8m█", { 128, 128, 128}} },
    { "ff0000SYS", {"\033[38;5;9m█", { 255, 0, 0}} },
    { "00ff00SYS", {"\033[38;5;10m█", { 0, 255, 0}} },
    { "ffff00SYS", {"\033[38;5;11m█", { 255, 255, 0}} },
    { "0000ffSYS", {"\033[38;5;12m█", { 0, 0, 255}} },
    { "ff00ffSYS", {"\033[38;5;13m█", { 255, 0, 255}} },
    { "00ffffSYS", {"\033[38;5;14m█", { 0, 255, 255}} },
    { "ffffffSYS", {"\033[38;5;15m█", { 255, 255, 255}} },
    { "000000", {"\033[38;5;16m█", { 0, 0, 0}} },
    { "00005f", {"\033[38;5;17m█", { 0, 0, 95}} },
    { "000087", {"\033[38;5;18m█", { 0, 0, 135}} },
    { "0000af", {"\033[38;5;19m█", { 0, 0, 175}} },
    { "0000d7", {"\033[38;5;20m█", { 0, 0, 215}} },
    { "0000ff", {"\033[38;5;21m█", { 0, 0, 255}} },
    { "005f00", {"\033[38;5;22m█", { 0, 95, 0}} },
    { "005f5f", {"\033[38;5;23m█", { 0, 95, 95}} },
    { "005f87", {"\033[38;5;24m█", { 0, 95, 135}} },
    { "005faf", {"\033[38;5;25m█", { 0, 95, 175}} },
    { "005fd7", {"\033[38;5;26m█", { 0, 95, 215}} },
    { "005fff", {"\033[38;5;27m█", { 0, 95, 255}} },
    { "008700", {"\033[38;5;28m█", { 0, 135, 0}} },
    { "00875f", {"\033[38;5;29m█", { 0, 135, 95}} },
    { "008787", {"\033[38;5;30m█", { 0, 135, 135}} },
    { "0087af", {"\033[38;5;31m█", { 0, 135, 175}} },
    { "0087d7", {"\033[38;5;32m█", { 0, 135, 215}} },
    { "0087ff", {"\033[38;5;33m█", { 0, 135, 255}} },
    { "00af00", {"\033[38;5;34m█", { 0, 175, 0}} },
    { "00af5f", {"\033[38;5;35m█", { 0, 175, 95}} },
    { "00af87", {"\033[38;5;36m█", { 0, 175, 135}} },
    { "00afaf", {"\033[38;5;37m█", { 0, 175, 175}} },
    { "00afd7", {"\033[38;5;38m█", { 0, 175, 215}} },
    { "00afff", {"\033[38;5;39m█", { 0, 175, 255}} },
    { "00d700", {"\033[38;5;40m█", { 0, 215, 0}} },
    { "00d75f", {"\033[38;5;41m█", { 0, 215, 95}} },
    { "00d787", {"\033[38;5;42m█", { 0, 215, 135}} },
    { "00d7af", {"\033[38;5;43m█", { 0, 215, 175}} },
    { "00d7d7", {"\033[38;5;44m█", { 0, 215, 215}} },
    { "00d7ff", {"\033[38;5;45m█", { 0, 215, 255}} },
    { "00ff00", {"\033[38;5;46m█", { 0, 255, 0}} },
    { "00ff5f", {"\033[38;5;47m█", { 0, 255, 95}} },
    { "00ff87", {"\033[38;5;48m█", { 0, 255, 135}} },
    { "00ffaf", {"\033[38;5;49m█", { 0, 255, 175}} },
    { "00ffd7", {"\033[38;5;50m█", { 0, 255, 215}} },
    { "00ffff", {"\033[38;5;51m█", { 0, 255, 255}} },
    { "5f0000", {"\033[38;5;52m█", { 95, 0, 0}} },
    { "5f005f", {"\033[38;5;53m█", { 95, 0, 95}} },
    { "5f0087", {"\033[38;5;54m█", { 95, 0, 135}} },
    { "5f00af", {"\033[38;5;55m█", { 95, 0, 175}} },
    { "5f00d7", {"\033[38;5;56m█", { 95, 0, 215}} },
    { "5f00ff", {"\033[38;5;57m█", { 95, 0, 255}} },
    { "5f5f00", {"\033[38;5;58m█", { 95, 95, 0}} },
    { "5f5f5f", {"\033[38;5;59m█", { 95, 95, 95}} },
    { "5f5f87", {"\033[38;5;60m█", { 95, 95, 135}} },
    { "5f5faf", {"\033[38;5;61m█", { 95, 95, 175}} },
    { "5f5fd7", {"\033[38;5;62m█", { 95, 95, 215}} },
    { "5f5fff", {"\033[38;5;63m█", { 95, 95, 255}} },
    { "5f8700", {"\033[38;5;64m█", { 95, 135, 0}} },
    { "5f875f", {"\033[38;5;65m█", { 95, 135, 95}} },
    { "5f8787", {"\033[38;5;66m█", { 95, 135, 135}} },
    { "5f87af", {"\033[38;5;67m█", { 95, 135, 175}} },
    { "5f87d7", {"\033[38;5;68m█", { 95, 135, 215}} },
    { "5f87ff", {"\033[38;5;69m█", { 95, 135, 255}} },
    { "5faf00", {"\033[38;5;70m█", { 95, 175, 0}} },
    { "5faf5f", {"\033[38;5;71m█", { 95, 175, 95}} },
    { "5faf87", {"\033[38;5;72m█", { 95, 175, 135}} },
    { "5fafaf", {"\033[38;5;73m█", { 95, 175, 175}} },
    { "5fafd7", {"\033[38;5;74m█", { 95, 175, 215}} },
    { "5fafff", {"\033[38;5;75m█", { 95, 175, 255}} },
    { "5fd700", {"\033[38;5;76m█", { 95, 215, 0}} },
    { "5fd75f", {"\033[38;5;77m█", { 95, 215, 95}} },
    { "5fd787", {"\033[38;5;78m█", { 95, 215, 135}} },
    { "5fd7af", {"\033[38;5;79m█", { 95, 215, 175}} },
    { "5fd7d7", {"\033[38;5;80m█", { 95, 215, 215}} },
    { "5fd7ff", {"\033[38;5;81m█", { 95, 215, 255}} },
    { "5fff00", {"\033[38;5;82m█", { 95, 255, 0}} },
    { "5fff5f", {"\033[38;5;83m█", { 95, 255, 95}} },
    { "5fff87", {"\033[38;5;84m█", { 95, 255, 135}} },
    { "5fffaf", {"\033[38;5;85m█", { 95, 255, 175}} },
    { "5fffd7", {"\033[38;5;86m█", { 95, 255, 215}} },
    { "5fffff", {"\033[38;5;87m█", { 95, 255, 255}} },
    { "870000", {"\033[38;5;88m█", { 135, 0, 0}} },
    { "87005f", {"\033[38;5;89m█", { 135, 0, 95}} },
    { "870087", {"\033[38;5;90m█", { 135, 0, 135}} },
    { "8700af", {"\033[38;5;91m█", { 135, 0, 175}} },
    { "8700d7", {"\033[38;5;92m█", { 135, 0, 215}} },
    { "8700ff", {"\033[38;5;93m█", { 135, 0, 255}} },
    { "875f00", {"\033[38;5;94m█", { 135, 95, 0}} },
    { "875f5f", {"\033[38;5;95m█", { 135, 95, 95}} },
    { "875f87", {"\033[38;5;96m█", { 135, 95, 135}} },
    { "875faf", {"\033[38;5;97m█", { 135, 95, 175}} },
    { "875fd7", {"\033[38;5;98m█", { 135, 95, 215}} },
    { "875fff", {"\033[38;5;99m█", { 135, 95, 255}} },
    { "878700", {"\033[38;5;100m█", { 135, 135, 0}} },
    { "87875f", {"\033[38;5;101m█", { 135, 135, 95}} },
    { "878787", {"\033[38;5;102m█", { 135, 135, 135}} },
    { "8787af", {"\033[38;5;103m█", { 135, 135, 175}} },
    { "8787d7", {"\033[38;5;104m█", { 135, 135, 215}} },
    { "8787ff", {"\033[38;5;105m█", { 135, 135, 255}} },
    { "87af00", {"\033[38;5;106m█", { 135, 175, 0}} },
    { "87af5f", {"\033[38;5;107m█", { 135, 175, 95}} },
    { "87af87", {"\033[38;5;108m█", { 135, 175, 135}} },
    { "87afaf", {"\033[38;5;109m█", { 135, 175, 175}} },
    { "87afd7", {"\033[38;5;110m█", { 135, 175, 215}} },
    { "87afff", {"\033[38;5;111m█", { 135, 175, 255}} },
    { "87d700", {"\033[38;5;112m█", { 135, 215, 0}} },
    { "87d75f", {"\033[38;5;113m█", { 135, 215, 95}} },
    { "87d787", {"\033[38;5;114m█", { 135, 215, 135}} },
    { "87d7af", {"\033[38;5;115m█", { 135, 215, 175}} },
    { "87d7d7", {"\033[38;5;116m█", { 135, 215, 215}} },
    { "87d7ff", {"\033[38;5;117m█", { 135, 215, 255}} },
    { "87ff00", {"\033[38;5;118m█", { 135, 255, 0}} },
    { "87ff5f", {"\033[38;5;119m█", { 135, 255, 95}} },
    { "87ff87", {"\033[38;5;120m█", { 135, 255, 135}} },
    { "87ffaf", {"\033[38;5;121m█", { 135, 255, 175}} },
    { "87ffd7", {"\033[38;5;122m█", { 135, 255, 215}} },
    { "87ffff", {"\033[38;5;123m█", { 135, 255, 255}} },
    { "af0000", {"\033[38;5;124m█", { 175, 0, 0}} },
    { "af005f", {"\033[38;5;125m█", { 175, 0, 95}} },
    { "af0087", {"\033[38;5;126m█", { 175, 0, 135}} },
    { "af00af", {"\033[38;5;127m█", { 175, 0, 175}} },
    { "af00d7", {"\033[38;5;128m█", { 175, 0, 215}} },
    { "af00ff", {"\033[38;5;129m█", { 175, 0, 255}} },
    { "af5f00", {"\033[38;5;130m█", { 175, 95, 0}} },
    { "af5f5f", {"\033[38;5;131m█", { 175, 95, 95}} },
    { "af5f87", {"\033[38;5;132m█", { 175, 95, 135}} },
    { "af5faf", {"\033[38;5;133m█", { 175, 95, 175}} },
    { "af5fd7", {"\033[38;5;134m█", { 175, 95, 215}} },
    { "af5fff", {"\033[38;5;135m█", { 175, 95, 255}} },
    { "af8700", {"\033[38;5;136m█", { 175, 135, 0}} },
    { "af875f", {"\033[38;5;137m█", { 175, 135, 95}} },
    { "af8787", {"\033[38;5;138m█", { 175, 135, 135}} },
    { "af87af", {"\033[38;5;139m█", { 175, 135, 175}} },
    { "af87d7", {"\033[38;5;140m█", { 175, 135, 215}} },
    { "af87ff", {"\033[38;5;141m█", { 175, 135, 255}} },
    { "afaf00", {"\033[38;5;142m█", { 175, 175, 0}} },
    { "afaf5f", {"\033[38;5;143m█", { 175, 175, 95}} },
    { "afaf87", {"\033[38;5;144m█", { 175, 175, 135}} },
    { "afafaf", {"\033[38;5;145m█", { 175, 175, 175}} },
    { "afafd7", {"\033[38;5;146m█", { 175, 175, 215}} },
    { "afafff", {"\033[38;5;147m█", { 175, 175, 255}} },
    { "afd700", {"\033[38;5;148m█", { 175, 215, 0}} },
    { "afd75f", {"\033[38;5;149m█", { 175, 215, 95}} },
    { "afd787", {"\033[38;5;150m█", { 175, 215, 135}} },
    { "afd7af", {"\033[38;5;151m█", { 175, 215, 175}} },
    { "afd7d7", {"\033[38;5;152m█", { 175, 215, 215}} },
    { "afd7ff", {"\033[38;5;153m█", { 175, 215, 255}} },
    { "afff00", {"\033[38;5;154m█", { 175, 255, 0}} },
    { "afff5f", {"\033[38;5;155m█", { 175, 255, 95}} },
    { "afff87", {"\033[38;5;156m█", { 175, 255, 135}} },
    { "afffaf", {"\033[38;5;157m█", { 175, 255, 175}} },
    { "afffd7", {"\033[38;5;158m█", { 175, 255, 215}} },
    { "afffff", {"\033[38;5;159m█", { 175, 255, 255}} },
    { "d70000", {"\033[38;5;160m█", { 215, 0, 0}} },
    { "d7005f", {"\033[38;5;161m█", { 215, 0, 95}} },
    { "d70087", {"\033[38;5;162m█", { 215, 0, 135}} },
    { "d700af", {"\033[38;5;163m█", { 215, 0, 175}} },
    { "d700d7", {"\033[38;5;164m█", { 215, 0, 215}} },
    { "d700ff", {"\033[38;5;165m█", { 215, 0, 255}} },
    { "d75f00", {"\033[38;5;166m█", { 215, 95, 0}} },
    { "d75f5f", {"\033[38;5;167m█", { 215, 95, 95}} },
    { "d75f87", {"\033[38;5;168m█", { 215, 95, 135}} },
    { "d75faf", {"\033[38;5;169m█", { 215, 95, 175}} },
    { "d75fd7", {"\033[38;5;170m█", { 215, 95, 215}} },
    { "d75fff", {"\033[38;5;171m█", { 215, 95, 255}} },
    { "d78700", {"\033[38;5;172m█", { 215, 135, 0}} },
    { "d7875f", {"\033[38;5;173m█", { 215, 135, 95}} },
    { "d78787", {"\033[38;5;174m█", { 215, 135, 135}} },
    { "d787af", {"\033[38;5;175m█", { 215, 135, 175}} },
    { "d787d7", {"\033[38;5;176m█", { 215, 135, 215}} },
    { "d787ff", {"\033[38;5;177m█", { 215, 135, 255}} },
    { "d7af00", {"\033[38;5;178m█", { 215, 175, 0}} },
    { "d7af5f", {"\033[38;5;179m█", { 215, 175, 95}} },
    { "d7af87", {"\033[38;5;180m█", { 215, 175, 135}} },
    { "d7afaf", {"\033[38;5;181m█", { 215, 175, 175}} },
    { "d7afd7", {"\033[38;5;182m█", { 215, 175, 215}} },
    { "d7afff", {"\033[38;5;183m█", { 215, 175, 255}} },
    { "d7d700", {"\033[38;5;184m█", { 215, 215, 0}} },
    { "d7d75f", {"\033[38;5;185m█", { 215, 215, 95}} },
    { "d7d787", {"\033[38;5;186m█", { 215, 215, 135}} },
    { "d7d7af", {"\033[38;5;187m█", { 215, 215, 175}} },
    { "d7d7d7", {"\033[38;5;188m█", { 215, 215, 215}} },
    { "d7d7ff", {"\033[38;5;189m█", { 215, 215, 255}} },
    { "d7ff00", {"\033[38;5;190m█", { 215, 255, 0}} },
    { "d7ff5f", {"\033[38;5;191m█", { 215, 255, 95}} },
    { "d7ff87", {"\033[38;5;192m█", { 215, 255, 135}} },
    { "d7ffaf", {"\033[38;5;193m█", { 215, 255, 175}} },
    { "d7ffd7", {"\033[38;5;194m█", { 215, 255, 215}} },
    { "d7ffff", {"\033[38;5;195m█", { 215, 255, 255}} },
    { "ff0000", {"\033[38;5;196m█", { 255, 0, 0}} },
    { "ff005f", {"\033[38;5;197m█", { 255, 0, 95}} },
    { "ff0087", {"\033[38;5;198m█", { 255, 0, 135}} },
    { "ff00af", {"\033[38;5;199m█", { 255, 0, 175}} },
    { "ff00d7", {"\033[38;5;200m█", { 255, 0, 215}} },
    { "ff00ff", {"\033[38;5;201m█", { 255, 0, 255}} },
    { "ff5f00", {"\033[38;5;202m█", { 255, 95, 0}} },
    { "ff5f5f", {"\033[38;5;203m█", { 255, 95, 95}} },
    { "ff5f87", {"\033[38;5;204m█", { 255, 95, 135}} },
    { "ff5faf", {"\033[38;5;205m█", { 255, 95, 175}} },
    { "ff5fd7", {"\033[38;5;206m█", { 255, 95, 215}} },
    { "ff5fff", {"\033[38;5;207m█", { 255, 95, 255}} },
    { "ff8700", {"\033[38;5;208m█", { 255, 135, 0}} },
    { "ff875f", {"\033[38;5;209m█", { 255, 135, 95}} },
    { "ff8787", {"\033[38;5;210m█", { 255, 135, 135}} },
    { "ff87af", {"\033[38;5;211m█", { 255, 135, 175}} },
    { "ff87d7", {"\033[38;5;212m█", { 255, 135, 215}} },
    { "ff87ff", {"\033[38;5;213m█", { 255, 135, 255}} },
    { "ffaf00", {"\033[38;5;214m█", { 255, 175, 0}} },
    { "ffaf5f", {"\033[38;5;215m█", { 255, 175, 95}} },
    { "ffaf87", {"\033[38;5;216m█", { 255, 175, 135}} },
    { "ffafaf", {"\033[38;5;217m█", { 255, 175, 175}} },
    { "ffafd7", {"\033[38;5;218m█", { 255, 175, 215}} },
    { "ffafff", {"\033[38;5;219m█", { 255, 175, 255}} },
    { "ffd700", {"\033[38;5;220m█", { 255, 215, 0}} },
    { "ffd75f", {"\033[38;5;221m█", { 255, 215, 95}} },
    { "ffd787", {"\033[38;5;222m█", { 255, 215, 135}} },
    { "ffd7af", {"\033[38;5;223m█", { 255, 215, 175}} },
    { "ffd7d7", {"\033[38;5;224m█", { 255, 215, 215}} },
    { "ffd7ff", {"\033[38;5;225m█", { 255, 215, 255}} },
    { "ffff00", {"\033[38;5;226m█", { 255, 255, 0}} },
    { "ffff5f", {"\033[38;5;227m█", { 255, 255, 95}} },
    { "ffff87", {"\033[38;5;228m█", { 255, 255, 135}} },
    { "ffffaf", {"\033[38;5;229m█", { 255, 255, 175}} },
    { "ffffd7", {"\033[38;5;230m█", { 255, 255, 215}} },
    { "ffffff", {"\033[38;5;231m█", { 255, 255, 255}} },
    { "080808", {"\033[38;5;232m█", { 8, 8, 8}} },
    { "121212", {"\033[38;5;233m█", { 18, 18, 18}} },
    { "1c1c1c", {"\033[38;5;234m█", { 28, 28, 28}} },
    { "262626", {"\033[38;5;235m█", { 38, 38, 38}} },
    { "303030", {"\033[38;5;236m█", { 48, 48, 48}} },
    { "3a3a3a", {"\033[38;5;237m█", { 58, 58, 58}} },
    { "444444", {"\033[38;5;238m█", { 68, 68, 68}} },
    { "4e4e4e", {"\033[38;5;239m█", { 78, 78, 78}} },
    { "585858", {"\033[38;5;240m█", { 88, 88, 88}} },
    { "626262", {"\033[38;5;241m█", { 98, 98, 98}} },
    { "6c6c6c", {"\033[38;5;242m█", { 108, 108, 108}} },
    { "767676", {"\033[38;5;243m█", { 118, 118, 118}} },
    { "808080", {"\033[38;5;244m█", { 128, 128, 128}} },
    { "8a8a8a", {"\033[38;5;245m█", { 138, 138, 138}} },
    { "949494", {"\033[38;5;246m█", { 148, 148, 148}} },
    { "9e9e9e", {"\033[38;5;247m█", { 158, 158, 158}} },
    { "a8a8a8", {"\033[38;5;248m█", { 168, 168, 168}} },
    { "b2b2b2", {"\033[38;5;249m█", { 178, 178, 178}} },
    { "bcbcbc", {"\033[38;5;250m█", { 188, 188, 188}} },
    { "c6c6c6", {"\033[38;5;251m█", { 198, 198, 198}} },
    { "d0d0d0", {"\033[38;5;252m█", { 208, 208, 208}} },
    { "dadada", {"\033[38;5;253m█", { 218, 218, 218}} },
    { "e4e4e4", {"\033[38;5;254m█", { 228, 228, 228}} },
    { "eeeeee", {"\033[38;5;255m█", { 238, 238, 238}} }
  };

string colorToANSI(color* c) {
  string hexString = c->hexString();
  if(xtermANSI.find(hexString) == xtermANSI.end()) {
    uint minDist = 0xFFFFFFFF;
    uint index = 0;
    string hexOverride;
    for(auto kvPair : xtermANSI) {
      color diff = get<1>(kvPair.second) - *c;
      int total = diff.r + diff.g + diff.b;
      if(kvPair.first.find("SYS") == string::npos && total < minDist) {
	hexOverride = kvPair.first;
	minDist = total;
      }
    }
    xtermANSI[hexString] = xtermANSI[hexOverride];
  }
  return get<0>(xtermANSI[hexString]);
}

#endif
